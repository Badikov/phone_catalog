.pagination
  %ul
    - if @total_pages > 1
      - if @page == 1
        %li.disabled
          %a
            &laquo;
      - else
        %li
          = link_to_page(@page - 1, "&laquo;", path_prefix)

      - if @total_pages <= 5
        - (1..@total_pages).each do |p|
          = render "shared/pager/page_number", page: p, current_page: @page, prefix: path_prefix
      - else
        = render "shared/pager/page_number", page: 1, current_page: @page, prefix: path_prefix

        - if [1, 2, 3, @total_pages - 1, @total_pages].include?(@page)
          = render "shared/pager/page_number", page: 2, current_page: @page, prefix: path_prefix

        - if [1, 2, @total_pages - 1, @total_pages].include?(@page)
          = render "shared/pager/gap"
        - else
          - if @page - 1 > 2
            = render "shared/pager/gap"
          = render "shared/pager/page_number", page: @page, current_page: @page, prefix: path_prefix
          - if @total_pages - @page > 2
            = render "shared/pager/gap"

        - if [1, 2, @total_pages - 2, @total_pages - 1, @total_pages].include?(@page)
          = render "shared/pager/page_number", page: @total_pages - 1, current_page: @page, prefix: path_prefix

        = render "shared/pager/page_number", page: @total_pages, current_page: @page, prefix: path_prefix

      - if @page == @total_pages
        %li.disabled
          %a
            &raquo;
      - else
        %li
          = link_to_page(@page + 1, "&raquo;", path_prefix)